# LifePlan Navigator - Auditor用品質保証チェックリスト

**文書番号**: LPN-AUD-001
**バージョン**: 1.0
**作成日**: 2025-12-11
**作成者**: CSIRT Team Leader
**対象**: Auditor

---

## 1. 監査概要

### 1.1 監査目的
LifePlan Navigator MVPリリースに向けた品質保証監査を実施し、リリース可否を判定する。

### 1.2 監査範囲
- アプリケーション実装の品質
- セキュリティ対策の妥当性
- ドキュメントの完成度
- コンプライアンス要件の充足
- インシデント対応体制の整備状況

### 1.3 監査基準
- NIST CSF 2.0
- ISO 27001
- OWASP Top 10 (2021)
- 個人情報保護法

---

## 2. セキュリティ監査チェックリスト

### 2.1 脆弱性対応状況

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 2.1.1 | 脆弱性診断が実施されている | VULNERABILITY_ASSESSMENT_REPORT.md確認 | □ | 12件発見 |
| 2.1.2 | Critical脆弱性が対処されている | 実装コード確認 | □ | VER-001要確認 |
| 2.1.3 | High脆弱性が対処または緩和されている | 実装コード確認 | □ | |
| 2.1.4 | 残存リスクが文書化されている | QUALITY_MANAGEMENT_REPORT.md確認 | □ | |
| 2.1.5 | リスク受容判断が適切に記録されている | 上記レポート確認 | □ | |

### 2.2 セキュリティヘッダー

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 2.2.1 | Content-Security-Policy設定 | next.config.mjs確認 | □ | |
| 2.2.2 | X-Frame-Options: DENY | next.config.mjs確認 | □ | |
| 2.2.3 | X-Content-Type-Options: nosniff | next.config.mjs確認 | □ | |
| 2.2.4 | Strict-Transport-Security設定 | next.config.mjs確認 | □ | |
| 2.2.5 | Referrer-Policy設定 | next.config.mjs確認 | □ | |
| 2.2.6 | Permissions-Policy設定 | next.config.mjs確認 | □ | |

### 2.3 CSRF対策

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 2.3.1 | CSRFトークン生成ロジックが安全 | csrf.ts確認 | □ | crypto.randomBytes使用 |
| 2.3.2 | タイミング攻撃対策実装 | csrf.ts確認 | □ | timingSafeEqual使用 |
| 2.3.3 | Cookie設定が適切（SameSite等） | middleware.ts確認 | □ | |
| 2.3.4 | **httpOnly設定とDouble Submit Cookieの整合性** | middleware.ts + api-client.ts確認 | □ | **要修正項目** |
| 2.3.5 | CSRFトークン検証が正常動作 | 動作テスト | □ | |

### 2.4 XSS対策

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 2.4.1 | CSPによるインラインスクリプト制限 | next.config.mjs確認 | □ | 開発用unsafe-inline許可 |
| 2.4.2 | Reactの自動エスケープ使用 | コンポーネント確認 | □ | |
| 2.4.3 | dangerouslySetInnerHTML不使用 | コード検索 | □ | |
| 2.4.4 | 外部データの適切なサニタイズ | 該当コード確認 | □ | |

---

## 3. コード品質監査チェックリスト

### 3.1 アプリケーション構造

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 3.1.1 | ディレクトリ構造が適切 | ファイル構成確認 | □ | src/, components/, lib/ |
| 3.1.2 | コンポーネントが適切に分割 | コード確認 | □ | 7コンポーネント |
| 3.1.3 | 型定義が適切（TypeScript） | types/確認 | □ | |
| 3.1.4 | 状態管理が適切（Zustand） | lib/store.ts確認 | □ | |

### 3.2 テスト

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 3.2.1 | ユニットテスト存在 | __tests__/確認 | □ | |
| 3.2.2 | E2Eテスト存在 | e2e/確認 | □ | Playwright |
| 3.2.3 | テストが実行可能 | npm test実行 | □ | |
| 3.2.4 | テストカバレッジが適切 | coverage確認 | □ | |

### 3.3 ビルド・デプロイ

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 3.3.1 | ビルドが成功する | npm run build | □ | |
| 3.3.2 | 本番用設定が分離されている | 環境変数確認 | □ | |
| 3.3.3 | 依存パッケージに脆弱性なし | npm audit | □ | |

---

## 4. ドキュメント監査チェックリスト

### 4.1 設計ドキュメント

| # | チェック項目 | ドキュメント | 結果 | 備考 |
|---|-------------|-------------|------|------|
| 4.1.1 | システムアーキテクチャ文書 | 01_system_architecture.md | □ | |
| 4.1.2 | 技術スタック文書 | 02_tech_stack.md | □ | |
| 4.1.3 | API仕様書 | 03_api_specification.md | □ | |
| 4.1.4 | データベース設計書 | 04_database_design.md | □ | |
| 4.1.5 | ネットワーク設計書 | 05_network_infrastructure_design.md | □ | |
| 4.1.6 | ファイアウォール設計書 | 06_firewall_policy.md | □ | |

### 4.2 セキュリティドキュメント

| # | チェック項目 | ドキュメント | 結果 | 備考 |
|---|-------------|-------------|------|------|
| 4.2.1 | セキュリティ要件定義書 | LifePlan_Navigator_Security_Requirements.md | □ | |
| 4.2.2 | 脆弱性診断レポート | VULNERABILITY_ASSESSMENT_REPORT.md | □ | |
| 4.2.3 | セキュリティ検証レポート | SECURITY_VERIFICATION_REPORT.md | □ | |
| 4.2.4 | 脅威分析レポート | LifePlan_Navigator_Threat_Analysis_Report.md | □ | |

### 4.3 運用ドキュメント

| # | チェック項目 | ドキュメント | 結果 | 備考 |
|---|-------------|-------------|------|------|
| 4.3.1 | SOC監視設計書 | LifePlan_Navigator_SOC_Monitoring_Design.md | □ | |
| 4.3.2 | 検知ルール集 | LifePlan_Navigator_Detection_Rules.md | □ | |
| 4.3.3 | アラートルール集 | LifePlan_Navigator_Alert_Rules.md | □ | |
| 4.3.4 | SOC Runbook | LifePlan_Navigator_SOC_Runbook.md | □ | |
| 4.3.5 | ログ管理設計書 | LifePlan_Navigator_Log_Management.md | □ | |
| 4.3.6 | 調査機能設計書 | LifePlan_Navigator_Investigation_Capabilities.md | □ | |
| 4.3.7 | フォレンジック手順書 | LifePlan_Navigator_Forensic_Procedures.md | □ | |
| 4.3.8 | 復旧手順書 | LifePlan_Navigator_Recovery_Procedures.md | □ | |

### 4.4 インシデント対応ドキュメント

| # | チェック項目 | ドキュメント | 結果 | 備考 |
|---|-------------|-------------|------|------|
| 4.4.1 | インシデント対応手順書 | 01_Incident_Response_Procedure.md | □ | SANS PICERL準拠 |
| 4.4.2 | エスカレーションマトリクス | 02_Escalation_Matrix.md | □ | |
| 4.4.3 | 対応シナリオ集 | 03_Incident_Response_Scenarios.md | □ | 4シナリオ |

---

## 5. コンプライアンス監査チェックリスト

### 5.1 NIST CSF 2.0 準拠

| # | 機能 | チェック項目 | 結果 | 備考 |
|---|------|-------------|------|------|
| 5.1.1 | GOVERN | セキュリティガバナンス体制 | □ | 14エージェント体制 |
| 5.1.2 | IDENTIFY | 資産・リスク管理 | □ | 脅威分析完了 |
| 5.1.3 | PROTECT | 保護対策実装 | □ | セキュリティヘッダー等 |
| 5.1.4 | DETECT | 検知能力 | □ | 検知ルール定義済 |
| 5.1.5 | RESPOND | 対応体制 | □ | インシデント手順完備 |
| 5.1.6 | RECOVER | 復旧能力 | □ | 復旧手順定義済 |

### 5.2 個人情報保護法準拠

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 5.2.1 | 個人情報取扱方針の明確化 | 要件定義確認 | □ | |
| 5.2.2 | 漏洩時報告フローの整備 | インシデント手順確認 | □ | 速報3-5日以内 |
| 5.2.3 | 本人通知プロセスの整備 | インシデント手順確認 | □ | |
| 5.2.4 | データ保護対策の実装 | セキュリティ実装確認 | □ | |

### 5.3 OWASP Top 10 対応

| # | カテゴリ | 対応状況確認 | 結果 | 備考 |
|---|---------|-------------|------|------|
| 5.3.1 | A01: Broken Access Control | 設計確認 | □ | Phase 2対応 |
| 5.3.2 | A02: Cryptographic Failures | 実装確認 | □ | |
| 5.3.3 | A03: Injection | 実装確認 | □ | CSP対応 |
| 5.3.4 | A04: Insecure Design | 設計文書確認 | □ | |
| 5.3.5 | A05: Security Misconfiguration | 設定確認 | □ | |
| 5.3.6 | A06: Vulnerable Components | npm audit | □ | |
| 5.3.7 | A07: Auth Failures | 設計確認 | □ | Phase 2対応 |
| 5.3.8 | A08: Data Integrity | 実装確認 | □ | |
| 5.3.9 | A09: Logging Failures | 設計確認 | □ | Phase 2実装 |
| 5.3.10 | A10: SSRF | 実装確認 | □ | 非該当 |

---

## 6. インシデント対応体制監査

### 6.1 体制整備

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 6.1.1 | 対応組織が定義されている | 手順書確認 | □ | |
| 6.1.2 | 役割分担が明確である | エスカレーション表確認 | □ | |
| 6.1.3 | 連絡体制が整備されている | 連絡先一覧確認 | □ | |
| 6.1.4 | オンコール体制が定義されている | エスカレーション表確認 | □ | |

### 6.2 対応プロセス

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 6.2.1 | SANS PIECRLプロセスに準拠 | 手順書確認 | □ | |
| 6.2.2 | 重大度分類が定義されている | 手順書確認 | □ | P0-P3 |
| 6.2.3 | SLAが定義されている | エスカレーション表確認 | □ | |
| 6.2.4 | 具体的シナリオが整備されている | シナリオ集確認 | □ | 4シナリオ |

### 6.3 証跡管理

| # | チェック項目 | 確認方法 | 結果 | 備考 |
|---|-------------|---------|------|------|
| 6.3.1 | 記録項目が定義されている | 手順書確認 | □ | |
| 6.3.2 | 証跡保管期間が定義されている | 手順書確認 | □ | |
| 6.3.3 | フォレンジック手順が整備されている | 手順書確認 | □ | |

---

## 7. リリース判定

### 7.1 必須条件チェック

| # | 条件 | 状態 | 判定 |
|---|------|------|------|
| 7.1.1 | Critical脆弱性がすべて対処されている | | □ Pass / □ Fail |
| 7.1.2 | セキュリティヘッダーが適切に設定されている | | □ Pass / □ Fail |
| 7.1.3 | CSRF対策が正常に動作する | | □ Pass / □ Fail |
| 7.1.4 | ビルドが成功する | | □ Pass / □ Fail |
| 7.1.5 | テストがすべてパスする | | □ Pass / □ Fail |
| 7.1.6 | 必須ドキュメントが揃っている | | □ Pass / □ Fail |
| 7.1.7 | インシデント対応体制が整備されている | | □ Pass / □ Fail |

### 7.2 最終判定

```
┌─────────────────────────────────────────────────────────────┐
│  リリース判定                                                 │
│                                                             │
│  □ 承認（リリース可）                                         │
│  □ 条件付き承認（以下の条件を満たした後リリース可）              │
│    条件: ____________________________________________        │
│  □ 不承認（以下の理由により再作業が必要）                       │
│    理由: ____________________________________________        │
└─────────────────────────────────────────────────────────────┘
```

---

## 8. 監査結果記録

### 8.1 指摘事項

| # | 重大度 | 指摘内容 | 対応期限 | 対応状況 |
|---|--------|---------|---------|---------|
| 1 | | | | |
| 2 | | | | |
| 3 | | | | |

### 8.2 改善勧告

| # | 勧告内容 | 優先度 | 対応期限 |
|---|---------|--------|---------|
| 1 | | | |
| 2 | | | |
| 3 | | | |

### 8.3 良好点

| # | 内容 |
|---|------|
| 1 | |
| 2 | |
| 3 | |

---

## 9. 署名

| 役割 | 氏名 | 日付 | 署名 |
|------|------|------|------|
| 監査担当（Auditor） | | | |
| 監査レビュー（CISO） | | | |
| 最終承認（CEO） | | | |

---

## 10. 参照ドキュメント

| # | ドキュメント | 保存場所 |
|---|-------------|---------|
| 1 | 品質管理統括レポート | docs/lifeplan-navigator/QUALITY_MANAGEMENT_REPORT.md |
| 2 | 脆弱性診断レポート | docs/VULNERABILITY_ASSESSMENT_REPORT.md |
| 3 | セキュリティ検証レポート | docs/SECURITY_VERIFICATION_REPORT.md |
| 4 | インシデント対応手順書 | docs/lifeplan-navigator/incident-response/ |
| 5 | プロジェクト要件書 | docs/PROJECT_REQUIREMENTS.md |

---

## 改訂履歴

| バージョン | 日付 | 変更内容 | 作成者 |
|------------|------|----------|--------|
| 1.0 | 2025-12-11 | 初版作成 | CSIRT Team Leader |

---

*本文書は監査専用です。取り扱いには十分ご注意ください。*
